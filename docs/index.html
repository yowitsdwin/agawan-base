<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="description" content="Agawan Base - Classic Filipino multiplayer game">
    <meta name="theme-color" content="#2d3436">
    <title>üéÆ Agawan Base - Multiplayer Game</title>
    
    <!-- Fonts -->
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    
    <!-- Styles -->
    <link rel="stylesheet" href="style.css">
    
    <!-- iOS Meta Tags -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Agawan Base">
</head>
<body>
    <div id="gameContainer">
        <!-- Loading Screen -->
        <div id="loadingScreen" class="screen">
            <div class="screen-content">
                <div class="loader"></div>
                <h2>Connecting to Server...</h2>
                <p id="loadingStatus">Checking server availability</p>
                <p style="font-size: 0.8em; color: #888; margin-top: 20px;">
                    ‚è±Ô∏è First connection may take 30s if server is sleeping
                </p>
            </div>
        </div>

        <!-- Main Menu -->
        <div id="mainMenuScreen" class="screen hidden">
            <div class="screen-content">
                <h1>üéÆ Agawan Base</h1>
                <p>A Classic Filipino Multiplayer Game</p>
                <input type="text" id="usernameInput" placeholder="Enter your name" maxlength="20" autocomplete="off">
                <div class="menu-buttons">
                    <button id="hostGameBtn" class="primary-btn">Host Game</button>
                    <button id="joinGameBtn" class="secondary-btn">Join Game</button>
                </div>
            </div>
        </div>

        <!-- Join Lobby Screen -->
        <div id="joinLobbyScreen" class="screen hidden">
            <div class="screen-content">
                <h1>Join Lobby</h1>
                <p>Enter the lobby code to join</p>
                <input type="text" id="lobbyCodeInput" placeholder="Enter 6-digit code" maxlength="6" 
                       style="text-transform: uppercase;" autocomplete="off">
                <div class="menu-buttons">
                    <button id="confirmJoinBtn" class="primary-btn">Join</button>
                    <button id="backToMenuBtn" class="secondary-btn">Back</button>
                </div>
            </div>
        </div>

        <!-- Host Settings Screen -->
        <div id="hostSettingsScreen" class="screen hidden">
            <div class="screen-content">
                <h1>Host Game Settings</h1>
                
                <div class="settings-group">
                    <label>Map Selection:</label>
                    <select id="mapSelect">
                        <option value="classic">Classic Field</option>
                        <option value="forest">Forest Arena</option>
                        <option value="desert">Desert Wasteland</option>
                    </select>
                </div>

                <div class="settings-group">
                    <label>Winning Score:</label>
                    <select id="winningScoreSelect">
                        <option value="3" selected>3 Points</option>
                        <option value="5">5 Points</option>
                        <option value="7">7 Points</option>
                        <option value="10">10 Points</option>
                    </select>
                </div>

                <div class="settings-group">
                    <label>Game Mode:</label>
                    <select id="gameModeSelect">
                        <option value="day" selected>Day Mode</option>
                        <option value="night">Night Mode (Flashlight)</option>
                    </select>
                </div>

                <div class="menu-buttons">
                    <button id="createLobbyBtn" class="primary-btn">Create Lobby</button>
                    <button id="backToMenuFromHostBtn" class="secondary-btn">Back</button>
                </div>
            </div>
        </div>

        <!-- Lobby Screen -->
        <div id="lobbyScreen" class="screen hidden">
            <div class="screen-content lobby-content">
                <div class="lobby-header">
                    <h1>Game Lobby</h1>
                    <div class="lobby-code">
                        <span>Lobby Code:</span>
                        <span id="lobbyCodeDisplay" class="code-display">------</span>
                        <button id="copyLobbyCodeBtn" class="icon-btn" title="Copy Code">üìã</button>
                    </div>
                </div>

                <div id="lobbySettingsPanel" class="lobby-settings">
                    <h3>Game Settings</h3>
                    <div class="settings-display">
                        <span>Map: <strong id="currentMap">Classic Field</strong></span>
                        <span>Score: <strong id="currentScore">3</strong></span>
                        <span>Mode: <strong id="currentMode">Day</strong></span>
                    </div>
                    <button id="editSettingsBtn" class="small-btn hidden">Edit Settings</button>
                </div>

                <div class="lobby-teams-container">
                    <div class="lobby-team-panel" id="lobbyRedTeam">
                        <h2>Red Team</h2>
                        <ul></ul>
                    </div>
                    <div class="lobby-team-panel" id="lobbyBlueTeam">
                        <h2>Blue Team</h2>
                        <ul></ul>
                    </div>
                </div>

                <div class="lobby-controls">
                    <button id="changeTeamBtn">Change Team</button>
                    <button id="readyBtn">Ready</button>
                    <button id="leaveLobbyBtn" class="danger-btn">Leave Lobby</button>
                </div>
                <p id="waitingMessage">Waiting for all players to ready up...</p>
            </div>
        </div>

        <!-- Game Screen -->
        <div id="gameScreen" class="screen hidden">
            <div id="gameUI">
                <div id="scoreboard">
                    <div class="team-score red-team">
                        <span class="team-name">Red</span>
                        <span class="score" id="redScore">0</span>
                    </div>
                    <div id="timer">5:00</div>
                    <div class="team-score blue-team">
                        <span class="team-name">Blue</span>
                        <span class="score" id="blueScore">0</span>
                    </div>
                    <button id="toggleLeaderboardBtn" class="icon-btn" title="Toggle Leaderboard">üèÜ</button>
                </div>

                <div id="leaderboard" class="hidden">
                    <h3>Leaderboard</h3>
                    <div id="leaderboardContent"></div>
                </div>
                
                <div id="chat-ui-container">
                    <button id="chatToggleBtn" class="icon-btn" title="Toggle Chat">üí¨</button>
                    <div id="chatContainer" class="hidden">
                        <div id="chatMessages"></div>
                        <div id="chatInput">
                            <select id="chatType" title="Chat Type">
                                <option value="global">All</option>
                                <option value="team">Team</option>
                            </select>
                            <input type="text" id="messageInput" placeholder="Type..." maxlength="100" autocomplete="off">
                            <button id="sendMessageBtn">Send</button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div id="gameCanvas"></div>
            
            <!-- Mobile Controls -->
            <div id="mobileControls" class="mobile-only">
                <div id="joystick-container">
                    <div id="joystick"></div>
                </div>
                <div id="flashlight-joystick-container">
                    <div id="flashlight-joystick"></div>
                </div>
                <button id="actionBtn" class="action-btn">Rescue</button>
            </div>
        </div>

        <!-- Game Over Screen -->
        <div id="gameOverScreen" class="screen hidden">
            <div class="screen-content">
                <h1 id="gameOverTitle">Game Over!</h1>
                <div id="gameOverStats"></div>
                <div class="menu-buttons">
                    <button id="playAgainBtn" class="primary-btn">Back to Lobby</button>
                    <button id="mainMenuBtn" class="secondary-btn">Main Menu</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Orientation Warning (Mobile) -->
    <div id="orientation-warning">
        <div class="screen-content">
            <h1>üéÆ Agawan Base</h1>
            <p>üì± Please rotate your device to landscape mode to play.</p>
        </div>
    </div>

    <!-- Scripts - FIXED CDN URLs -->
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/phaser@3.70.0/dist/phaser.min.js"></script>
    
    <!-- Game Scripts -->
    <script src="js/constants.js"></script>
    <script src="js/NetworkManager.js"></script>
    <script src="js/Controls.js"></script>
    <script src="js/UIManager.js"></script>
    <script src="js/GameScene.js"></script>
    <script src="js/main.js"></script>
</body>
</html>